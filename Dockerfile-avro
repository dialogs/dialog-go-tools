FROM golang:1.13-stretch as avro-builder

ARG GOBIN=/go/bin
ARG REPO=github.com/actgardner/gogen-avro
ARG DIR=${GOPATH}/src/${REPO}

RUN apt-get update -y && \
    mkdir -p ${DIR} && \
    git clone -b v6.2.0 https://${REPO} ${DIR} && \
    go install ${REPO}/gogen-avro

FROM golang:1.13-stretch

COPY --from=avro-builder go/bin/gogen-avro /usr/local/bin/gogen-avro

CMD exit 1