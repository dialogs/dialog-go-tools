FROM golang:1.14-stretch as avro-builder

ARG GOBIN=/go/bin
ARG REPO=github.com/actgardner/gogen-avro
ARG DIR=${GOPATH}/src/${REPO}

RUN apt-get update -y && \
    mkdir -p ${DIR} && \
    git clone -b v7.0.0 https://${REPO} ${DIR} && \
    go install ${REPO}/v7/cmd/...

FROM golang:1.14-stretch

COPY --from=avro-builder go/bin/gogen-avro /usr/local/bin/gogen-avro

CMD exit 1